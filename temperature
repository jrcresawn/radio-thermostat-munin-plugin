#!/usr/bin/env python

# temperature - retrieve temperature from thermostat
#
# Usage: temperature [config]
#
#
# Copyright (c) 2012, James Ryan Cresawn
# All rights reserved.

import httplib
import json
import sys

if len(sys.argv) > 2:
    sys.exit('Usage: %s [config]' % sys.argv[0])
elif len(sys.argv) > 1:
    if sys.argv[1] == "config":
        print "graph_category thermostat"
        print "graph_title Temperature"
        print "graph_vlabel degrees (F)"
        print "temperature.label degrees (F)"
        sys.exit(0)
    else:
        sys.exit('Usage: %s [config]' % sys.argv[0])

conn = httplib.HTTPConnection("192.168.10.15")
conn.request("GET", "/tstat/temp")
r = conn.getresponse()
if r.status == 200:
    data = r.read()
    conn.close()
    d = json.loads(data)
    print "temperature.value", d['temp']
else:
    sys.exit(1)
